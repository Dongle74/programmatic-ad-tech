**爱卡-流量接入指南**

**V1.01**

  ------------------ -------------------
  **模块名称**       爱卡-流量接入指南
  **所属系统**       爱卡NVWA系统
  **模块负责人**     史连俊
  **项目负责人**     史连俊
  **文档提交日期**   2018-10-08
  ------------------ -------------------

**修改记录**

  -------- ------------------ -------------------- -------------- ------------
  **No**   **修改后版本号**   **修改内容简介**     **修改日期**   **修改人**
  1        V1.0               全文初稿             2018/10/08     史连俊
  2        V1.01              增加区域与车价范围   2018/12/14     史连俊
  -------- ------------------ -------------------- -------------- ------------

目录 {#目录 .ad}
====

[[接口定义]{.underline} 4](#接口定义)

[[消息定义]{.underline} 4](#消息定义)

[[1.Request]{.underline} 4](#request)

[[1.1 request对象]{.underline} 4](#request对象)

[[1.2 imp对象]{.underline} 4](#imp对象)

[[1.2.1 imp.ext对象]{.underline} 5](#imp.ext对象)

[[1.3 app对象]{.underline} 5](#app对象)

[[1.4 device对象]{.underline} 5](#device对象)

[[1.5 site对象]{.underline} 6](#site对象)

[[1.6 request示例:]{.underline} 6](#request示例)

[[2 Response]{.underline} 7](#response)

[[2.1 response对象]{.underline} 7](#response对象)

[[2.2 ads对象]{.underline} 7](#ads对象)

[[2.3 native对象]{.underline} 8](#native对象)

[[2.4 response示例]{.underline} 8](#response示例)

[[附录]{.underline} 9](#附录)

[[设备联网方式]{.underline} 9](#设备联网方式)

[[设备类型]{.underline} 9](#设备类型)

接口定义
========

> 媒体广告请求使用http
> post方式进行交互，请求消息格式为JSON，访问超时设置为
> 800ms，开启keep-alive，Content-Type 设为
> application/json，字符编码为utf-8

消息定义
========

1.Request
---------

### 1.1 request对象

  **字段名称**   **类型**   **是否必须**   **说明**
  -------------- ---------- -------------- ---------------------------------
  id             string     Y              request的唯一id
  imp            array      Y              曝光对象，一次请求可包含多个imp
  app            object     Y              媒体信息
  device         object     Y              设备信息
  site           object     N              当请求由浏览器发起时提供

### 1.2 imp对象

  **字段名称**   **类型**   **是否必须**   **说明**
  -------------- ---------- -------------- ------------------------------
  id             string     Y              imp的唯一id
  posId          string     Y              广告位标示（由爱卡线下提供）
  ext            object     N              扩展字段

### 1.2.1 imp.ext对象

  **字段名称**   **类型**   **是否必须**   **说明**
  -------------- ---------- -------------- ----------
  channel        string     N              频道
  autoBrand      string     N              品牌
  autoGrade      string     N              车系
  area           string     N              地域
  priceRange     string     N              车价范围

### 1.3 app对象

  **字段名称**   **类型**   **是否必须**   **说明**
  -------------- ---------- -------------- ----------------------------
  id             string     Y              媒体标示（由爱卡线下提供）
  name           string     N              媒体名称

### 1.4 device对象

+-----------------+-----------------+-----------------+-----------------+
| **字段名称**    | **类型**        | **是否必须**    | **说明**        |
+-----------------+-----------------+-----------------+-----------------+
| did             | ![](media/image | Y               | ![](media/image |
|                 | 1.png){width="9 |                 | 1.png){width="9 |
|                 | .02777777777777 |                 | .02777777777777 |
|                 | 7e-3in"         |                 | 7e-3in"         |
|                 | height="9.02777 |                 | height="9.02777 |
|                 | 7777777777e-3in |                 | 7777777777e-3in |
|                 | "}string        |                 | "}IMEI(Android) |
|                 |                 |                 | 、IDFA(iOS)、Cook |
|                 |                 |                 | ie(PC)          |
+-----------------+-----------------+-----------------+-----------------+
| ip              | string          | Y               | 客户端IP地址    |
+-----------------+-----------------+-----------------+-----------------+
| carrier         | ![](media/image | N               | ![](media/image |
|                 | 1.png){width="9 |                 | 1.png){width="9 |
|                 | .02777777777777 |                 | .02777777777777 |
|                 | 7e-3in"         |                 | 7e-3in"         |
|                 | height="9.02777 |                 | height="9.02777 |
|                 | 7777777777e-3in |                 | 7777777777e-3in |
|                 | "}integer       |                 | "}运营商，1:移动; |
|                 |                 |                 |                 |
|                 |                 |                 | 2:联通; 3:电信; |
|                 |                 |                 | 0:未知          |
+-----------------+-----------------+-----------------+-----------------+
| make            | ![](media/image | N               | ![](media/image |
|                 | 1.png){width="9 |                 | 1.png){width="9 |
|                 | .02777777777777 |                 | .02777777777777 |
|                 | 7e-3in"         |                 | 7e-3in"         |
|                 | height="9.02777 |                 | height="9.02777 |
|                 | 7777777777e-3in |                 | 7777777777e-3in |
|                 | "}string        |                 | "}设备制造商    |
+-----------------+-----------------+-----------------+-----------------+
| model           | ![](media/image | N               | ![](media/image |
|                 | 1.png){width="9 |                 | 1.png){width="9 |
|                 | .02777777777777 |                 | .02777777777777 |
|                 | 7e-3in"         |                 | 7e-3in"         |
|                 | height="9.02777 |                 | height="9.02777 |
|                 | 7777777777e-3in |                 | 7777777777e-3in |
|                 | "}string        |                 | "}设备型号      |
+-----------------+-----------------+-----------------+-----------------+
| os              | ![](media/image | Y               | ![](media/image |
|                 | 1.png){width="9 |                 | 1.png){width="9 |
|                 | .02777777777777 |                 | .02777777777777 |
|                 | 7e-3in"         |                 | 7e-3in"         |
|                 | height="9.02777 |                 | height="9.02777 |
|                 | 7777777777e-3in |                 | 7777777777e-3in |
|                 | "}integer       |                 | "}操作系统      |
|                 |                 |                 |                 |
|                 |                 |                 | 1:iOS,2:Android |
|                 |                 |                 | ,3:windows,0:其他 |
+-----------------+-----------------+-----------------+-----------------+
| osv             | string          | N               | 操作系统版本号  |
+-----------------+-----------------+-----------------+-----------------+
| connectionType  | integer         | Y               | 设备联网方式，见附录 |
+-----------------+-----------------+-----------------+-----------------+
| deviceType      | ![](media/image | Y               | ![](media/image |
|                 | 1.png){width="9 |                 | 1.png){width="9 |
|                 | .02777777777777 |                 | .02777777777777 |
|                 | 7e-3in"         |                 | 7e-3in"         |
|                 | height="9.02777 |                 | height="9.02777 |
|                 | 7777777777e-3in |                 | 7777777777e-3in |
|                 | "}integer       |                 | "}设备类型，见附录 |
+-----------------+-----------------+-----------------+-----------------+

### 1.5 site对象

  -------------- ---------- -------------- -------------
  **字段名称**   **类型**   **是否必须**   **说明**
  name           string     Y              站点名称
  page           string     Y              当前页面Url
  ref            string     Y              ReferrerUrl
  -------------- ---------- -------------- -------------

### 1.6 request示例: 

> {
>
> \"id\": \"1440645700531182\",
>
> \"app\": {
>
> \"appId\": \"12ewe\",
>
> \"name\": \"爱卡\"
>
> },
>
> \"imp\": \[{
>
> \"id\": \"12ewe5jsaslgpuqwer\",
>
> \"posId\": \"001\",
>
> \"ext\": {
>
> \"channel\": \"1\",
>
> \"autoBrand\": \"123\",
>
> \"autoGrade\": \"345\"
>
> }
>
> }\],
>
> \"device\": {
>
> \"id\": \"110255157105\",
>
> \"ip\": \"110.255.157.105\",
>
> \"did\": \"123456789012345\",
>
> \"carrier\": 0,
>
> \"make\": \"uawei\",
>
> \"model\": \"p20\",
>
> \"os\": 2,
>
> \"osv\": \"8.1.3\",
>
> \"connectionType\": 1,
>
> \"deviceType\": 6
>
> }
>
> }

2 Response
----------

> 正常响应返回的http状态码为200，不出广告则为
> 204。其他情况当做出错处理，如 403 forbidden 或 500 internal server
> error。

### 2.1 response对象

  -------------- ---------- -------------- -------------
  **字段名称**   **类型**   **是否必须**   **说明**
  id             string     Y              request的id
  ads            array      Y              广告信息
  -------------- ---------- -------------- -------------

### 2.2 ads对象

  -------------- ---------- -------------- ------------------------
  **字段名称**   **类型**   **是否必须**   **说明**
  impId          string     Y              请求中的imp的id
  posId          string     Y              广告位ID
  cid            string     Y              广告物料ID
  img            string     Y              图片物料地址
  video          string     Y              视频物料地址
  pm             array      Y              曝光监测地址（支持宏）
  cm             array      Y              点击监测地址（支持宏）
  ldp            string     Y              落地页地址
  native         object     N              信息流广告必填
  -------------- ---------- -------------- ------------------------

### 2.3 native对象

  **字段名称**   **类型**   **是否必须**   **说明**
  -------------- ---------- -------------- ------------------
  name           string     Y              名称
  title          string     Y              标题
  portrait       string     Y              头图
  button         string     Y              按钮文案
  imgs           array      Y              广告图片物料地址
  desc           string     Y              描述

### 2.4 response示例

> {
>
> \"ads\": \[{
>
> \"impId\": \"12ewe5jsaslgpuqwer\",
>
> \"posId\": \"001\",
>
> \"cid\": \"1\",
>
> \"img\": \"http://xxx.xxx.xxx/xxx.xxx\",
>
> \"video\": \"http://xxx.xxx.xxx/xxx.xxx\",
>
> \"ldp\": \"http://xxx.xxx.xxx/xxx.xxx\",
>
> \"pm\": \[\"http://xxx.xxx.xxx/xxx.xxx\",
>
> http://xxx.xxx.xxx/xxx.xxx\"
>
> \],
>
> \"cm\": \[\"http://xxx.xxx.xxx/xxx.xxx\",
>
> http://xxx.xxx.xxx/xxx.xxx\"
>
> \]
>
> }\],
>
> \"id\": \"1440645700531182\"
>
> }

附录
====

设备联网方式
------------

  -------- -------------
  **值**   **说明**
  0        未知
  1        wifi
  2        蜂窝数据-2G
  3        蜂窝数据-3G
  4        蜂窝数据-4G
  -------- -------------

设备类型
--------

  -------- ----------
  **值**   **说明**
  0        未知
  1        Phone
  2        Pad
  3        PC
  4        TV
  -------- ----------
